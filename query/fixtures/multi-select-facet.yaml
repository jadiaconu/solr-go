---
version: 1
interactions:
- request:
    body: '{"facet":{"brands":{"facet":{"productCount":"uniqueBlock(_root_)"},"field":"brand","limit":-1,"type":"terms"},"categories":{"facet":{"productCount":"uniqueBlock(_root_)"},"field":"category","limit":-1,"type":"terms"},"colors":{"domain":{"excludeTags":"top","filter":["{!filters
      param=$child.fq  excludeTags=color v=$child.query}","{!child of=$parent.fq filters=$fq
      v=$parent.fq}"]},"facet":{"productCount":"uniqueBlock(_root_)"},"field":"color","limit":-1,"type":"terms"},"product_types":{"facet":{"productCount":"uniqueBlock(_root_)"},"field":"product_type","limit":-1,"type":"terms"},"sizes":{"domain":{"excludeTags":"top","filter":["{!filters
      param=$child.fq excludeTags=size v=$child.query}","{!child of=$parent.fq filters=$fq
      v=$parent.fq}"]},"facet":{"productCount":"uniqueBlock(_root_)"},"field":"size","limit":-1,"type":"terms"}},"fields":"*","filter":["{!tag=top}category:clothes"],"queries":{"child.fq":["{!tag=color}color:black
      OR color:blue","{!tag=size}size:L OR size:M"],"child.query":"scope:sku","parent.fq":"scope:product"},"query":"{!parent
      tag=top filters=$child.fq which=$parent.fq v=$child.query}"}'
    form: {}
    headers:
      Content-Type:
      - application/json
    url: http://localhost:8983/solr/multi-select/query
    method: POST
  response:
    body: |
      {
        "responseHeader":{
          "status":0,
          "QTime":0,
          "params":{
            "json":"{\"facet\":{\"brands\":{\"facet\":{\"productCount\":\"uniqueBlock(_root_)\"},\"field\":\"brand\",\"limit\":-1,\"type\":\"terms\"},\"categories\":{\"facet\":{\"productCount\":\"uniqueBlock(_root_)\"},\"field\":\"category\",\"limit\":-1,\"type\":\"terms\"},\"colors\":{\"domain\":{\"excludeTags\":\"top\",\"filter\":[\"{!filters param=$child.fq  excludeTags=color v=$child.query}\",\"{!child of=$parent.fq filters=$fq v=$parent.fq}\"]},\"facet\":{\"productCount\":\"uniqueBlock(_root_)\"},\"field\":\"color\",\"limit\":-1,\"type\":\"terms\"},\"product_types\":{\"facet\":{\"productCount\":\"uniqueBlock(_root_)\"},\"field\":\"product_type\",\"limit\":-1,\"type\":\"terms\"},\"sizes\":{\"domain\":{\"excludeTags\":\"top\",\"filter\":[\"{!filters param=$child.fq excludeTags=size v=$child.query}\",\"{!child of=$parent.fq filters=$fq v=$parent.fq}\"]},\"facet\":{\"productCount\":\"uniqueBlock(_root_)\"},\"field\":\"size\",\"limit\":-1,\"type\":\"terms\"}},\"fields\":\"*\",\"filter\":[\"{!tag=top}category:clothes\"],\"queries\":{\"child.fq\":[\"{!tag=color}color:black OR color:blue\",\"{!tag=size}size:L OR size:M\"],\"child.query\":\"scope:sku\",\"parent.fq\":\"scope:product\"},\"query\":\"{!parent tag=top filters=$child.fq which=$parent.fq v=$child.query}\"}"}},
        "response":{"numFound":3,"start":0,"docs":[
            {
              "brand":["Calvin Klein"],
              "category":["clothes"],
              "id":"1",
              "product_type":"dress",
              "scope":"product",
              "_version_":1668926256678174720},
            {
              "brand":["Calvin Klein"],
              "category":["clothes"],
              "id":"2",
              "product_type":"jeans",
              "scope":"product",
              "_version_":1668926256684466176},
            {
              "brand":["Levi’s"],
              "category":["clothes"],
              "id":"3",
              "product_type":"jeans",
              "scope":"product",
              "_version_":1668926256690757632}]
        },
        "facets":{
          "count":3,
          "brands":{
            "buckets":[{
                "val":"Calvin Klein",
                "count":2,
                "productCount":2},
              {
                "val":"Levi’s",
                "count":1,
                "productCount":1}]},
          "categories":{
            "buckets":[{
                "val":"clothes",
                "count":3,
                "productCount":3}]},
          "colors":{
            "buckets":[{
                "val":"blue",
                "count":4,
                "productCount":3},
              {
                "val":"black",
                "count":2,
                "productCount":1},
              {
                "val":"red",
                "count":1,
                "productCount":1}]},
          "product_types":{
            "buckets":[{
                "val":"jeans",
                "count":2,
                "productCount":2},
              {
                "val":"dress",
                "count":1,
                "productCount":1}]},
          "sizes":{
            "buckets":[{
                "val":"L",
                "count":3,
                "productCount":2},
              {
                "val":"M",
                "count":3,
                "productCount":3}]}}}
    headers:
      Content-Length:
      - "2996"
      Content-Security-Policy:
      - default-src 'none'; base-uri 'none'; connect-src 'self'; form-action 'self';
        font-src 'self'; frame-ancestors 'none'; img-src 'self'; media-src 'self';
        style-src 'self' 'unsafe-inline'; script-src 'self'; worker-src 'self';
      Content-Type:
      - application/json;charset=utf-8
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - 1; mode=block
    status: 200 OK
    code: 200
    duration: ""
